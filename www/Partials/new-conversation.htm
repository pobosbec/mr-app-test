<div ng-controller="NewConversationController">

    <div ng-show="successText!=null" class="alert alert-success">{{ successText }}</div>
    <div ng-show="errorText!=null" class="alert alert-danger">{{ errorText }}</div>

    <div class="scrollable content-container">
        <div class="scrollable-content section overthrow">

            <div class="list-group">

                <div class="list-group-item text-center">
                    <h1>New Conversation</h1>
                </div>

                <div class="list-group-item">

                    <form name="findUserForm" role="form" class="form-group form-new-conversation">
                        <h2>Add recipient</h2>
                        <label>Find by username, email or phone</label>
                        <input type="text" ng-model="searchText" class="form-control" ng-minlength="3" placeholder="Search for user" required>
                        <button class="btn btn-lg btn-primary btn-block" ng-click="FindUser(searchText,inboxId)" ng-disabled="!findUserForm.$valid" type="submit">Find user</button>
                        <hr/>
                        <div ng-show="searchResult.items.length > 0">
                            <label>Search results: {{ searchResult.numberOfItems }}, showing {{ searchResult.items.length }}</label>
                            <div class="list-group">
                                <div ng-repeat="user in searchResult.items" class="list-group-item">
                                    <div class="list-item-button">
                                        <button class="btn btn-sm btn-primary" ng-click="AddRecipient(user);" type="submit">+</button>
                                    </div>
                                    <div class="list-item-avatar">
                                        <img ng-show="user.avatar != null" width="30" alt="avatar" src="{{ user.avatar }}"/>
                                    </div>
                                    <div class="list-group-item-text">{{user.userDisplayName}} ({{user.username}}) [phone:{{user.phoneNumber}}, email:{{user.email}}]</div>
                                </div>
                            </div>
                        </div>
                    </form>

                </div>

                <div class="list-group-item">
                    <form name="newConversationForm" role="form" class="form-group form-new-conversation">
                        <div class="list-group">
                            <div ng-repeat="user in recipients" class="list-group-item">
                                <div class="list-item-button">
                                    <button class="btn btn-sm btn-primary" ng-click="RemoveRecipient(user);" type="submit">-</button>
                                </div>
                                <div class="list-item-avatar">
                                    <img ng-show="user.avatar != null" width="30" alt="avatar" src="{{ user.avatar }}"/>
                                </div>
                                <div class="list-group-item-text">{{user.userDisplayName}} ({{user.username}}) [phone:{{user.phoneNumber}}, email:{{user.email}}]</div>
                            </div>
                        </div>
                        <label>Message text</label>
                        <textarea ng-model="messageText" class="form-control" placeholder="Message text" required></textarea>
                        <button class="btn btn-lg btn-primary btn-block" ng-click="CreateNewConversation(inboxId,messageText)" ng-disabled="!newConversationForm.$valid" type="submit">Create new conversation</button>
                    </form>
                </div>

            </div>

        </div>

    </div>
</div>




