<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-controller="materialadminCtrl as mactrl">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title></title>


    <!-- ICON and font -->
    <link rel="stylesheet" href="css/material-design-iconic-font.min.css">

    <!-- CSS -->
    <link href="css/app.min.1.css" rel="stylesheet" id="app-level">
    <link href="css/app.min.2.css" rel="stylesheet">
    <link href="css/css-override.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <link href="bower_components/snapjs/snap.css" rel="stylesheet">
    <link href="bower_components/angular-snap/angular-snap.css" rel="stylesheet">
    <link href="node_modules/node-waves/dist/waves.min.js" rel="stylesheet">

    <script src="js/version.js"></script>
    <!--<script src="https://s3-eu-west-1.amazonaws.com/app.aws.mobileresponse.se/www/js/version.js"></script> -->
    <script src="node_modules/fastclick/lib/fastclick.js"></script>
    <!-- in order not to get problems related to angular and jquery performance issue. loading order should be jQuery>jQueryMobile>Angularmin-->
    <!-- Jquery -->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <!-- Angular -->
    <script src="bower_components/snapjs/snap.js"></script>
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="bower_components/angular-snap/angular-snap.js"></script>
    <script src="node_modules/angular-resource/angular-resource.min.js"></script>
    <script src="js/ng-cordova.js"></script>
    <script src="bower_components/ng-fastclick/dist/index.min.js"></script>
    <script src="node_modules/node-waves/dist/waves.min.js"></script>

    <!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
    <script type="text/javascript">
        window.cookieconsent_options = { "message": "This website uses cookies to ensure you get the best experience on our website", "dismiss": "Got it!", "learnMore": "More info", "link": null, "theme": "light-top" };
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>
    <!-- End Cookie Consent plugin -->
</head>
<body data-ng-controller="eventCtrl as ectrl">
    <div class="loading-screen" ng-class="loading?'fadeShow':'fadeHide'">
        <div class="spinner"></div>
    </div>
    <div class="btn btn-warning" style="cursor:default; position: absolute; top: 0px; left: 50%; transform: translate(-50%, 0); z-index: 9998;" ng-show="slowConnection">
        <i class="zmdi zmdi-hourglass-alt zmdi-hc-spin"></i>&nbsp;&nbsp;Slow Connection detected
    </div>
    <div>
        <div data-ng-include="'template/sidebar-drawer.html'"></div>
    </div>
    <div id="content" snap-content class="snap-content">
        <header id="header" ng-show="header" data-current-skin={{mactrl.currentSkin}} data-ng-include="'template/header.html'" style="position: fixed; top:0;left: 0;right:0; z-index: 2 !important;" data-ng-controller="headerCtrl as hctrl"></header>
        <a ng-show="createButtonVisible" ng-click="opencreate()" class="btn btn-login btn-danger btn-float" value="newMsg" style="z-index: 3; position: fixed; bottom:25px; right:25px"><i class="zmdi zmdi-plus"></i></a>
        <data class="view" ui-view></data>
    </div>

    <!-- bootstrap -->
    <!--<script src="node_modules/angular/angular.intellisense.js"></script>-->
    <script src="node_modules/angular-messages/angular-messages.min.js"></script>
    <script src="node_modules/angular-animate/angular-animate.min.js"></script>

    <!--<link href="node_modules/angular-loading-bar/build/loading-bar.min.css" type="text/css" media="all" rel="stylesheet"/>
    <script src="node_modules/angular-loading-bar/build/loading-bar.min.js"></script>-->
    <!-- Angular ui router -->
    <script src="node_modules/angular-ui-router/release/angular-ui-router.min.js"></script>
    <script src="node_modules/angular-ui-bootstrap/dist/ui-bootstrap-tpls.js"></script>
    <script src="node_modules/angular-moment/node_modules/moment/moment.js"></script>
    <script src="node_modules/angular-moment/angular-moment.min.js"></script>
    <script src='node_modules/fastclick/lib/fastclick.js'></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and res queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Angular modules below -->
    <script src="app/app.js"></script>
    <script src="app/config.js"></script>
    <script src="app/controllers/main.js"></script>
    <script src="app/modules/events.js"></script>
    <script src="app/modules/ui.js"></script>
    <script src="app/modules/messages.js"></script>
    <script src="app/modules/modal.js"></script>
    <script src="app/modules/login.js"></script>
    <script src="app/modules/settings.js"></script>
    <script src="app/modules/contacts.js"></script>
    <script src="app/modules/conversations.js"></script>
    <script src="app/modules/editprofile.js"></script>
    <script src="app/directives.js"></script>
    <script src="app/factories/token-factory.js"></script>
    <script src="app/factories/message-repository-factory.js"></script>
    <script src="app/factories/communication-factory.js"></script>
    <script src="app/factories/contacts-repository.js"></script>
    <script src="app/filters.js"></script>

    <script language="javascript">

        Waves.init();

        function isAndroid() {
            return navigator.userAgent.indexOf("Android") > 0;
        }

        function isIOS() {
            return (navigator.userAgent.indexOf("iPhone") > 0 || navigator.userAgent.indexOf("iPad") > 0 || navigator.userAgent.indexOf("iPod") > 0);
        }

        function loadScript(scriptUrl) {
            console.log(">> Loading: " + scriptUrl);
            var script = document.createElement('script');
            script.src = scriptUrl;
            script.onload = function () {
                console.log(">> Loaded: " + scriptUrl);
            };

            document.head.appendChild(script);
        }

        var app = document.URL.indexOf('http://') === -1 && document.URL.indexOf('https://') === -1;
        if (app) {
            // PhoneGap application
            window.isPhoneGap = true;
            loadCordova();
        } else {
            // Web page
            window.isPhoneGap = false;
            window.deviceType = 0;
            angular.bootstrap(document, ['administratorApp']);
        }

        function loadCordova() {
            window.deviceType = 0;
            var CORDOVA_EDITION = null;
            if (isAndroid()) {
                CORDOVA_EDITION = "android";
                window.deviceType = 3;
            } else if (isIOS()) {
                CORDOVA_EDITION = "ios";
                window.deviceType = 1;
            }
            window.isPhoneGap = (CORDOVA_EDITION !== null);
            loadScript("js/index.js");
            if (CORDOVA_EDITION != null) {
                loadScript("cordova.js");
                // now add plugins
                if (isIOS()) {
                    loadScript("js/PushwooshiOS.js");
                }
                if (isAndroid()) {
                    loadScript("js/PushwooshAndroid.js");
                }

                document.addEventListener('deviceready', function () {
                    //temp
                    console.log("Device ready first row");

                    initPushwoosh();
                    StatusBar.overlaysWebView(false);
                    console.log("Device ready initiating Angular");
                    angular.bootstrap(document, ['administratorApp']);
                }, false);

                document.addEventListener('DOMContentLoaded', function () {
                    FastClick.attach(document.body);
                }, false);

            }
        }
    </script>
</body>
</html>
